# MQ-2模拟烟雾传感器

## 一、产品简介
&emsp;&emsp;
MQ-2烟雾传感器可用于家庭和工厂的气体泄漏监测装置，适宜于液化气、苯、烷、酒精、氢气、烟雾等的探测。故因此，MQ-2可以准确来说是一个多种气体探测器。
它的探测范围极其广泛，并且具有灵敏度高、响应快、稳定性好、寿命长、驱动电路简单等优点。

<div align="center">
<img src=./../images/ext_MQ2烟雾传感器_定义尺寸.png  width=100%/>
</div>

<br>

## 二、技术参数
* 具有输出调节电位器：顺时针调节大，逆时针调节小。<br>
* 传感器类型：模拟<br>
* 快速响应和高灵敏度<br>
* 简单电路板<br>
* 5V供电<br>
* 尺寸：36.4x26.6mm<br>

## 三、软件接口
<br>

### Gas(adcObj) - 创建燃气气体传感器驱动对象
<br>

* 函数原型

> var gasDev = gas.Gas(adcObj)

* 参数说明

参数|类型|必选参数？|说明|
|:-:|:-:|:-:|:-|
|adcObj|ADC|是|调用此函数前需确保adcObj对象已经处于open状态|

* 返回值

> 返回燃气对象；

* 示例代码
```js
import * as adc from 'adc'
import * as gas from './gas.js'

console.log('Testing gas ...');
var adcDev = adc.open({
    id: 'gas',
    success: function() {
        console.log('adc: open success')
    },
    fail: function() {
        console.log('adc: open failed')
    }
});

var gasDev = gas.Gas(adcDev);
```

* 输出
```js
Testing gas ...
adc: open success
```
</br>

### getVoltage() - 获取燃气气体浓度电压值
<br>

* 函数功能：

> 获取燃气气体浓度电压值

* 函数原型：

> Gas.getVoltage()

* 参数说明：

> 无

* 返回值：

> 返回燃气气体浓度电压值（数据类型：整型；单位：mv）；

* 示例：

```js
import * as adc from 'adc'
import * as gas from './gas.js'

console.log('Testing gas ...');
var adcDev = adc.open({
    id: 'gas',
    success: function() {
        console.log('adc: open success')
    },
    fail: function() {
        console.log('adc: open failed')
    }
});

var gasDev = gas.Gas(adcDev);
var value = gasDev.getVoltage();
console.log('The gas Voltage ' + value);
```

* 输出
```js
Testing fire ...
adc: open success
The gas voltage: 300
```

</br>

## 四、接口案例

此使用实例在app.json中定义了名为gas的ADC类型的对象。在js脚本中获取燃气气体值并打印在日志中。

* 案例代码
```js
{
  "name": "esp32",
  "version": "1.0.0",
  "io": {
      "gas": {
        "type": "ADC",
        "port": 0,
        "sampling": 12000000,
        "atten": 0,
        "width": 3
      }
  },
  "debugLevel": "ERROR",
  "repl": "disable"
}
```

```js
import * as adc from 'adc'
import * as gas from './gas.js'

console.log('Testing gas ...');
var adcDev = adc.open({
    id: 'gas',
    success: function() {
        console.log('adc: open success')
    },
    fail: function() {
        console.log('adc: open failed')
    }
});

var gasDev = gas.Gas(adcDev);
setInterval(function(){
    var value = gasDev.getVoltage();
    console.log('The gas Voltage ' + value);
}, 5000);
```

* 输出
```python
Testing fire ...
adc: open success
The gas voltage: 300
The gas voltage: 300
```

## 五、工作原理
MQ-2型模拟烟雾传感器属于二氧化锡半导体气敏材料，属于表面离子式N型半导体。处于200～300摄氏度时，二氧化锡吸附空气中的氧，形成氧的负离子吸附，使半导体的电子密度减少，从而使其电阻值增加。当与烟雾接触时，如果晶粒间界处的势垒收到烟雾的调至而变化，就会引起表面导电率的变化。利用这一点就可以获得这种烟雾存在的信息，烟雾的浓度越大，导电率越大，输出电阻越低，则输出的模拟信号就越大。

<br>

### 1、MQ-2的特性
MQ-2型传感器对天然气、液化石油气等烟雾有很高的灵敏度，尤其对烷类烟雾更为敏感，具有良好的抗干扰性，可准确排除有刺激性非可燃性烟雾的干扰信息。<br>
MQ-2型传感器具有良好的重复性和长期的稳定性。初始稳定，响应时间短，长时间工作性能好。需要注意的是：在使用之前必须加热一段时间，否则其输出的电阻和电压不准确。<br>
其检测可燃气体与烟雾的范围是100～10000ppm（ppm为体积浓度。1ppm = 1 立方厘米/1 立方米）。<br>

<br>

### 2、MQ-2的计算
用MQ-2模拟烟雾传感器来检测火灾烟雾的最好办法是通过其输出电压与门限电压比较得出。

<br>

MQ-2的计算公式

<br>

阻值R与空气中被测气体的浓度C的计算关系式
log R = mlog C + n (m,n均为常数)
常数n：与气体检测灵敏度有关，除了随传感器材料和气体种类不同而变化外，还会由于测量温度和激活剂的不同而发生大幅度的变化。
常数m：表示随气体浓度而变数的传感器的灵敏度（也称作为气体分离率）。对于可燃气气体来说，m的值多数介于1/2至1/3之间。

<br>

传感器的电阻的计算

<br>

参考MQ-2 datasheet可用下式 3-2计算：
Rs = (Vc/Vrl - 1）)* Rl

<br>

公式中Vc为回路电压，VRl是传感器4脚、6脚输出的电压即U,Rl是负载电阻。更具上式即可算出传感器电阻Rs。

<br>

MQ-2传感器的输出电压

<br>

根据MQ-2的工作原理（其导电率随着气体浓度的增大而增大，其电阻是电导率的倒数，所以电阻是随之减小的。其特性就相当于一个滑动变阻器）。
U=(R11/R11 + Rs) * Vc

<br>

Vc为回路电压即电源电压，其加在MQ-2传感器的1脚、3脚之间。U是传感器4脚、6脚输出的电压，Rs为传感器的体电阻。其中若气体浓度上升，必导致Rs下降。而Rs的下降则会导致MQ-2的4脚、6脚对地输出的电压增大。所以气体浓度增大，其输出的电压也会增大。

<br>

### 3、MQ-2的动静态校准
这一步就是设置合适的报警门限电压。其中要求动静态电压相差0.3～0.6V为最佳。

<br>

MQ-2传感器的静态校准

<br>

根据MQ-2的Datasheet要求以及此次设计的烟雾采集模块电路，将MQ-2烟雾信息采集模块通电，测得电压为5V。将传感器置于纯净的空气中，等待预热延时2分钟，用万用表测量此时的U,电压应为0.3～1V,若U点电压不在此范围内可调整R11电位器，并记录静态U的值。

<br>

表3-1是通过调节R11滑动变阻器的对10次采集模块静态校准试验所得U的值。

<br>

表3-1 MQ-2静态测量值

| 次数 | 1 | 2 |3 | 4| 5 | 6 | 7 | 8 | 9| 10 |
| :-: | :-: |  :- | :- | :- | :-: | :-: |  :- | :- | :- |:-|
|电压(V) |0.6|0.59|0.59|0.6|0.6|0.6|0.6|0.6|0.6|0.58|

<br>

此时测得滑动变阻器的值为2.5K欧姆，传感器体电阻公式为：
Rs = (Vc/Vrl -1) * Rl = （5/0.6 - 1 ）*2.5K = 31K

<br>

MQ-2传感器的动态校准

<br>

主要测试距离对输出电压的影响。传感器里火源越远，烟雾扩散的范围越大，单位体积内的烟雾浓度将减小。

<br>

距离烟雾传感器传感头5cm处点燃干燥的废纸产生烟雾飘入传感头，用万用表测量此时U的电压变化情况。表3-2为连续10次所测得的烟雾浓度对应的输出电压值。

<br>

表3-2 烟雾浓度与传感器到火源距离之间的测量（10cm）

| 次数 | 1 | 2 |3 | 4| 5 | 6 | 7 |8 | 9|10|
|:- |:-|:-|:-|:-|:-|:-|:-|:-|:-|:-|
|电压(V) |1.12|1.14|1.15|1.21|1.13|1.14|1.11|1.14|1.20|1.11|

此时的动态电压比静态电压上升了0.4～0.5V。

<br>

距离烟雾传感器传感头20cm处点燃干燥的废纸产生烟雾飘入传感头，用万用表测量此时U的电压变化情况。表3-3为连续10次所测得的此时烟雾浓度对应 的输出电压值。

<br>

表3-3 烟雾浓度与传感器到火源距离之间的测量(100cm)

| 次数 | 1 | 2 |3 | 4| 5 | 6 | 7 |8 | 9|10|
|:- |:-|:-|:-|:-|:-|:-|:-|:-|:-|:-|
|电压(V) |1.0|0.99|0.98|1.0|1.0|0.95|0.96|1.06|1.04|1.03|

此时的动态电压比静态电压上升了0.3～0.4V，说明了距离对烟雾浓度的影响是很大的。

<br>

距离烟雾传感器传感头5cm处用打火机对着传感头喷射其内部气体（主要成分是丁烷)。表3-4连续10次测得的此时的动态电压u的值。

<br>

表3-4 可燃气体浓度与传感器到火源距离之间的测量(10cm)

| 次数 | 1 | 2 |3 | 4| 5 | 6 | 7 |8 | 9|10|
|:- |:-|:-|:-|:-|:-|:-|:-|:-|:-|:-|
|电压(V) |3.2|3.3|3.4|3.5|3.6|3.2|3.3|3.3|3.4|3.1|

此时的动态电压比静态电压上升了2.6～2.9V。

<br>

距离烟雾传感器传感头20cm处用打火机对着传感头喷射其内部气体（主要成分是丁烷)。表3-5为连续10次测得的此时动态电压U的值。

<br>

| 次数 | 1 | 2 |3 | 4| 5 | 6 | 7 |8 | 9|10|
|:- |:-|:-|:-|:-|:-|:-|:-|:-|:-|:-|
|电压(V) |2.9|2.9|3.0|3.1|3.0|2.8|2.9|2.9|3.0|2.8|

此时的动态电压比静态电压上升了2.2～2.4V,说明烟雾浓度降低了，校准电压的时候应该考虑这一点。

<br>

传感器距离火源的远近，对应的烟雾浓度将会不一样。距离越近，其在相同环境下烟雾浓度越大；距离越远，其在相同环境下烟雾浓度越小。所以必须要设置合适的烟雾浓度门限对应的电压值。

<br>

## 三、技术参数
### 1、电气特性
<div align="center">
<img src=./../images/ext_MQ2烟雾传感器_电气特性.png  width=100%/>
</div>

<br>

### 2、性能指标
具有输出调节电位器：顺时针调节大，逆时针调节小。

<br>

传感器类型：模拟<br>
快速响应和高灵敏度<br>
简单电路板<br>
尺寸：36.4x26.6mm<br>

## 参考文献
[1] [模拟烟雾传感器](https://www.dfrobot.com.cn/goods-539.html) <br>
[2] [MQ-2烟雾传感器资料总结](https://blog.csdn.net/qq_40276310/article/details/80766166)
